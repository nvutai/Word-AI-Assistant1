<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url(https://themes.googleusercontent.com/fonts/css?kit=kbffV7V9BIH3Ot2AQ2LQRA);ol{margin:0;padding:0}table td,table th{padding:0}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Courier";font-style:normal}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c2{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.title{padding-top:24pt;color:#000000;font-weight:700;font-size:36pt;padding-bottom:6pt;font-family:"Arial";line-height:1.0;page-break-after:avoid;text-align:left}.subtitle{padding-top:18pt;color:#666666;font-size:24pt;padding-bottom:4pt;font-family:"Georgia";line-height:1.0;page-break-after:avoid;font-style:italic;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:12pt;color:#000000;font-weight:700;font-size:24pt;padding-bottom:12pt;font-family:"Arial";line-height:1.0;text-align:left}h2{padding-top:11.2pt;color:#000000;font-weight:700;font-size:18pt;padding-bottom:11.2pt;font-family:"Arial";line-height:1.0;text-align:left}h3{padding-top:12pt;color:#000000;font-weight:700;font-size:14pt;padding-bottom:12pt;font-family:"Arial";line-height:1.0;text-align:left}h4{padding-top:12.8pt;color:#000000;font-weight:700;font-size:12pt;padding-bottom:12.8pt;font-family:"Arial";line-height:1.0;text-align:left}h5{padding-top:12.8pt;color:#000000;font-weight:700;font-size:9pt;padding-bottom:12.8pt;font-family:"Arial";line-height:1.0;text-align:left}h6{padding-top:18pt;color:#000000;font-weight:700;font-size:8pt;padding-bottom:18pt;font-family:"Arial";line-height:1.0;text-align:left}</style></head><body class="c2 doc-content"><p class="c1"><span class="c0">&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br> &nbsp; &nbsp;&lt;meta charset=&quot;UTF-8&quot; /&gt;<br> &nbsp; &nbsp;&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=Edge&quot; /&gt;<br> &nbsp; &nbsp;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;<br> &nbsp; &nbsp;&lt;title&gt;Tr&#7907; l&yacute; Ng&ocirc;n ng&#7919; AI&lt;/title&gt;<br><br> &nbsp; &nbsp;&lt;!-- 1. T&#7843;i th&#432; vi&#7879;n Office.js --&gt;<br> &nbsp; &nbsp;&lt;script src=&quot;https://appsforoffice.microsoft.com/lib/1/hosted/office.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;<br><br> &nbsp; &nbsp;&lt;!-- 2. T&#7843;i Tailwind CSS v&agrave; Font Awesome --&gt;<br> &nbsp; &nbsp;&lt;script src=&quot;https://cdn.tailwindcss.com&quot;&gt;&lt;/script&gt;<br> &nbsp; &nbsp;&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css&quot;&gt;<br><br> &nbsp; &nbsp;&lt;!-- 3. CSS t&ugrave;y ch&#7881;nh cho giao di&#7879;n --&gt;<br> &nbsp; &nbsp;&lt;style&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;body {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;font-family: &#39;Inter&#39;, sans-serif;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-webkit-font-smoothing: antialiased;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-moz-osx-font-smoothing: grayscale;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.suggestion-card {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transition: all 0.2s ease-in-out;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;border-left-width: 4px;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.suggestion-card:hover {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transform: translateY(-2px);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;box-shadow: 0 4px 12px rgba(0,0,0,0.1);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.loader {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;border: 4px solid #f3f3f3;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;border-top: 4px solid #3b82f6;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;border-radius: 50%;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;width: 30px;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;height: 30px;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;animation: spin 1s linear infinite;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;@keyframes spin {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0% { transform: rotate(0deg); }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;100% { transform: rotate(360deg); }<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.explanation {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;max-height: 0;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;overflow: hidden;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;transition: max-height 0.3s ease-out;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;.explanation.show {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;max-height: 200px; /* Ho&#7863;c m&#7897;t gi&aacute; tr&#7883; &#273;&#7911; l&#7899;n */<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;/* M&agrave;u s&#7855;c cho c&aacute;c lo&#7841;i &#273;&#7873; xu&#7845;t */<br> &nbsp; &nbsp; &nbsp; &nbsp;.border-blue-500 { border-left-color: #3b82f6; } /* Ng&#7919; ph&aacute;p */<br> &nbsp; &nbsp; &nbsp; &nbsp;.border-purple-500 { border-left-color: #8b5cf6; } /* V&#259;n phong AI */<br> &nbsp; &nbsp;&lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body class=&quot;bg-gray-50 text-gray-800 flex flex-col h-screen&quot;&gt;<br> &nbsp; &nbsp;&lt;!-- TI&Ecirc;U &#272;&#7872; --&gt;<br> &nbsp; &nbsp;&lt;header class=&quot;p-4 border-b border-gray-200&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;h1 class=&quot;text-xl font-bold text-gray-900 flex items-center&quot;&gt;&lt;i class=&quot;fa-solid fa-robot text-blue-500 mr-2&quot;&gt;&lt;/i&gt;Tr&#7907; l&yacute; Ng&ocirc;n ng&#7919; AI&lt;/h1&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-sm text-gray-500&quot;&gt;Ph&acirc;n t&iacute;ch chuy&ecirc;n s&acirc;u b&#7903;i Google Gemini&lt;/p&gt;<br> &nbsp; &nbsp;&lt;/header&gt;<br><br> &nbsp; &nbsp;&lt;!-- N&Uacute;T H&Agrave;NH &#272;&#7896;NG V&Agrave; T&Oacute;M T&#7854;T --&gt;<br> &nbsp; &nbsp;&lt;div class=&quot;p-4&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;button id=&quot;check-button&quot; class=&quot;w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-colors duration-200 shadow-md flex items-center justify-center space-x-2 disabled:bg-gray-400 disabled:cursor-not-allowed&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;i class=&quot;fas fa-magic-sparkles&quot;&gt;&lt;/i&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span&gt;Ph&acirc;n t&iacute;ch to&agrave;n b&#7897; v&#259;n b&#7843;n&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;summary&quot; class=&quot;text-sm text-center text-gray-600 mt-3 hidden&quot;&gt;&lt;/div&gt;<br> &nbsp; &nbsp;&lt;/div&gt;<br><br> &nbsp; &nbsp;&lt;!-- KHU V&#7920;C HI&#7874;N TH&#7882; K&#7870;T QU&#7842; --&gt;<br> &nbsp; &nbsp;&lt;main id=&quot;results-container&quot; class=&quot;flex-grow p-4 overflow-y-auto bg-gray-100&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;loader&quot; class=&quot;hidden justify-center items-center flex-col text-center py-8&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;loader&quot;&gt;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p id=&quot;loader-text&quot; class=&quot;mt-3 text-sm text-gray-600&quot;&gt;&#272;ang g&#7917;i v&#259;n b&#7843;n &#273;&#7871;n AI...&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;placeholder&quot; class=&quot;text-center text-gray-500 py-8&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;i class=&quot;fa-solid fa-file-lines fa-3x text-gray-400&quot;&gt;&lt;/i&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;h3 class=&quot;mt-2 text-sm font-medium text-gray-900&quot;&gt;S&#7861;n s&agrave;ng ph&acirc;n t&iacute;ch&lt;/h3&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;mt-1 text-sm text-gray-500&quot;&gt;Nh&#7845;n n&uacute;t &#273;&#7875; AI b&#7855;t &#273;&#7847;u l&agrave;m vi&#7879;c.&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;div id=&quot;suggestion-list&quot; class=&quot;space-y-3&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;!-- C&aacute;c th&#7867; &#273;&#7873; xu&#7845;t s&#7869; &#273;&#432;&#7907;c ch&egrave;n v&agrave;o &#273;&acirc;y --&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp;&lt;/main&gt;<br> &nbsp; &nbsp;<br> &nbsp; &nbsp;&lt;footer class=&quot;p-2 text-center text-xs text-gray-400 border-t border-gray-200&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;p&gt;Powered by Google Gemini API&lt;/p&gt;<br> &nbsp; &nbsp;&lt;/footer&gt;<br><br> &nbsp; &nbsp;&lt;script type=&quot;text/javascript&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;Office.onReady((info) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (info.host === Office.HostType.Word) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(&quot;check-button&quot;).onclick = runAnalysis;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp;// =================================================================<br> &nbsp; &nbsp; &nbsp; &nbsp;// REAL GEMINI API INTEGRATION<br> &nbsp; &nbsp; &nbsp; &nbsp;// =================================================================<br><br> &nbsp; &nbsp; &nbsp; &nbsp;/**<br> &nbsp; &nbsp; &nbsp; &nbsp; * G&#7885;i API Gemini v&#7899;i c&#417; ch&#7871; th&#7917; l&#7841;i (exponential backoff).<br> &nbsp; &nbsp; &nbsp; &nbsp; * @param {string} sentence - C&acirc;u v&#259;n c&#7847;n ph&acirc;n t&iacute;ch.<br> &nbsp; &nbsp; &nbsp; &nbsp; * @param {number} maxRetries - S&#7889; l&#7847;n th&#7917; l&#7841;i t&#7889;i &#273;a.<br> &nbsp; &nbsp; &nbsp; &nbsp; * @returns {Promise&lt;object|null&gt;} - &#272;&#7889;i t&#432;&#7907;ng JSON ch&#7913;a g&#7907;i &yacute; ho&#7863;c null.<br> &nbsp; &nbsp; &nbsp; &nbsp; */<br> &nbsp; &nbsp; &nbsp; &nbsp;async function callGeminiApi(sentence, maxRetries = 3) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// **QUAN TR&#7884;NG**: Trong m&#7897;t &#7913;ng d&#7909;ng th&#7921;c t&#7871;, API key c&#7847;n &#273;&#432;&#7907;c qu&#7843;n l&yacute; an to&agrave;n<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// v&agrave; kh&ocirc;ng n&ecirc;n &#273;&#7875; l&#7897; trong m&atilde; ngu&#7891;n ph&iacute;a client.<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const apiKey = &quot;&quot;; // Canvas s&#7869; t&#7921; &#273;&#7897;ng cung c&#7845;p key n&agrave;y.<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Prompt &#273;&#432;&#7907;c thi&#7871;t k&#7871; &#273;&#7875; y&ecirc;u c&#7847;u AI tr&#7843; v&#7873; m&#7897;t c&#7845;u tr&uacute;c JSON c&#7909; th&#7875;.<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const prompt = `Ph&acirc;n t&iacute;ch c&acirc;u ti&#7871;ng Vi&#7879;t sau &#273;&acirc;y. N&#7871;u c&oacute; th&#7875; c&#7843;i thi&#7879;n, h&atilde;y vi&#7871;t l&#7841;i cho r&otilde; r&agrave;ng, s&uacute;c t&iacute;ch v&agrave; chuy&ecirc;n nghi&#7879;p h&#417;n.<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Ch&#7881; tr&#7843; l&#7901;i b&#7857;ng m&#7897;t &#273;&#7889;i t&#432;&#7907;ng JSON c&oacute; c&#7845;u tr&uacute;c: {&quot;suggestion&quot;: &quot;c&acirc;u &#273;&#7873; xu&#7845;t&quot;, &quot;explanation&quot;: &quot;gi&#7843;i th&iacute;ch ng&#7855;n g&#7885;n t&#7841;i sao&quot;}.<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;N&#7871;u c&acirc;u &#273;&atilde; t&#7889;t v&agrave; kh&ocirc;ng c&#7847;n s&#7917;a, h&atilde;y tr&#7843; v&#7873; JSON: {&quot;suggestion&quot;: null, &quot;explanation&quot;: null}.<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;C&acirc;u c&#7847;n ph&acirc;n t&iacute;ch: &quot;${sentence}&quot;`;<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const payload = {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;contents: [{ parts: [{ text: prompt }] }],<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;generationConfig: {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;responseMimeType: &quot;application/json&quot;,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (let i = 0; i &lt; maxRetries; i++) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const response = await fetch(apiUrl, {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;method: &#39;POST&#39;,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;headers: { &#39;Content-Type&#39;: &#39;application/json&#39; },<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;body: JSON.stringify(payload)<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!response.ok) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;throw new Error(`HTTP error! status: ${response.status}`);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const result = await response.json();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const text = result.candidates?.[0]?.content?.parts?.[0]?.text;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (text) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const parsedJson = JSON.parse(text);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (parsedJson.suggestion) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;type: &#39;V&#259;n phong&#39;,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;original: sentence,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;...parsedJson<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return null; // C&acirc;u &#273;&atilde; t&#7889;t ho&#7863;c kh&ocirc;ng c&oacute; ph&#7843;n h&#7891;i h&#7907;p l&#7879;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(`API call failed (attempt ${i + 1}):`, error);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (i === maxRetries - 1) throw error; // N&eacute;m l&#7895;i &#7903; l&#7847;n th&#7917; cu&#7889;i<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const delay = Math.pow(2, i) * 1000; // 1s, 2s, 4s<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await new Promise(res =&gt; setTimeout(res, delay));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return null;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;// =================================================================<br> &nbsp; &nbsp; &nbsp; &nbsp;// MAIN APPLICATION LOGIC<br> &nbsp; &nbsp; &nbsp; &nbsp;// =================================================================<br><br> &nbsp; &nbsp; &nbsp; &nbsp;async function runAnalysis() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const button = document.getElementById(&quot;check-button&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const suggestionList = document.getElementById(&quot;suggestion-list&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const loader = document.getElementById(&quot;loader&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const loaderText = document.getElementById(&quot;loader-text&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const placeholder = document.getElementById(&quot;placeholder&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const summary = document.getElementById(&quot;summary&quot;);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// V&ocirc; hi&#7879;u h&oacute;a n&uacute;t v&agrave; hi&#7875;n th&#7883; loader<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;button.disabled = true;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;button.querySelector(&#39;span&#39;).innerText = &quot;&#272;ang ph&acirc;n t&iacute;ch...&quot;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;loader.classList.remove(&quot;hidden&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;loader.classList.add(&quot;flex&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;placeholder.classList.add(&quot;hidden&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;suggestionList.innerHTML = &#39;&#39;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;summary.classList.add(&quot;hidden&quot;);<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await Word.run(async (context) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const body = context.document.body;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;context.load(body, &#39;text&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await context.sync();<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const text = body.text;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (!text.trim()) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; showPlaceholder(&quot;V&#259;n b&#7843;n tr&#7889;ng&quot;, &quot;Kh&ocirc;ng c&oacute; g&igrave; &#273;&#7875; ph&acirc;n t&iacute;ch.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const allSuggestions = [];<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 1. Ki&#7875;m tra l&#7895;i c&#417; b&#7843;n (l&#7863;p t&#7915;) - nhanh v&agrave; mi&#7877;n ph&iacute;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const repeatedWordRegex = /\b(\w+)\s+\1\b/gi;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;let match;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;while ((match = repeatedWordRegex.exec(text)) !== null) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;allSuggestions.push({<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;type: &#39;Ng&#7919; ph&aacute;p&#39;,<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;original: match[0],<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;suggestion: match[1],<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;explanation: &quot;L&#7895;i l&#7863;p t&#7915;.&quot;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 2. Ph&acirc;n t&iacute;ch v&#259;n phong v&#7899;i AI<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const sentences = text.match(/[^.!?]+[.!?]+/g) || [];<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const analysisPromises = [];<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for (const sentence of sentences) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (sentence.trim().length &gt; 10) { // Ch&#7881; ph&acirc;n t&iacute;ch c&acirc;u c&oacute; &#273;&#7897; d&agrave;i h&#7907;p l&yacute;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;analysisPromises.push(callGeminiApi(sentence.trim()));<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;loaderText.innerText = `&#272;ang g&#7917;i ${analysisPromises.length} c&acirc;u &#273;&#7871;n AI...`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const aiResults = await Promise.all(analysisPromises);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;aiResults.forEach(res =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (res) allSuggestions.push(res);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// 3. Hi&#7875;n th&#7883; k&#7871;t qu&#7843;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;loader.classList.add(&quot;hidden&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (allSuggestions.length &gt; 0) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;displaySuggestions(allSuggestions);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;updateSummary(allSuggestions);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showPlaceholder(&quot;V&#259;n b&#7843;n ho&agrave;n h&#7843;o!&quot;, &quot;AI kh&ocirc;ng t&igrave;m th&#7845;y &#273;&#7873; xu&#7845;t n&agrave;o &#273;&#7875; c&#7843;i thi&#7879;n.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} catch (error) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;console.error(&quot;L&#7895;i ph&acirc;n t&iacute;ch:&quot;, error);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showPlaceholder(&quot;G&#7863;p s&#7921; c&#7889; k&#7871;t n&#7889;i&quot;, &quot;Kh&ocirc;ng th&#7875; k&#7871;t n&#7889;i &#273;&#7871;n m&aacute;y ch&#7911; AI. Vui l&ograve;ng th&#7917; l&#7841;i sau.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} finally {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// K&iacute;ch ho&#7841;t l&#7841;i n&uacute;t<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;button.disabled = false;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;button.querySelector(&#39;span&#39;).innerText = &quot;Ph&acirc;n t&iacute;ch to&agrave;n b&#7897; v&#259;n b&#7843;n&quot;;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;function displaySuggestions(suggestions) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const list = document.getElementById(&quot;suggestion-list&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;list.innerHTML = &#39;&#39;;<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const typeStyles = {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;Ng&#7919; ph&aacute;p&#39;: { color: &#39;blue&#39;, icon: &#39;fa-comments&#39; },<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#39;V&#259;n phong&#39;: { color: &#39;purple&#39;, icon: &#39;fa-wand-magic-sparkles&#39; }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;};<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;suggestions.forEach((item, index) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const style = typeStyles[item.type];<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const card = document.createElement(&#39;div&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;card.className = `suggestion-card bg-white p-4 rounded-lg shadow-sm border-${style.color}-500`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;card.id = `card-${index}`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;card.innerHTML = `<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;flex justify-between items-start&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;span class=&quot;text-xs bg-${style.color}-100 text-${style.color}-800 font-medium px-2 py-1 rounded-full&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;i class=&quot;fas ${style.icon} mr-1&quot;&gt;&lt;/i&gt;${item.type}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/span&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;button class=&quot;ignore-btn text-gray-400 hover:text-gray-600&quot; data-card-id=&quot;card-${index}&quot;&gt;&lt;i class=&quot;fas fa-times&quot;&gt;&lt;/i&gt;&lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;mt-2 text-sm&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-gray-500&quot;&gt;G&#7889;c: &lt;span class=&quot;line-through&quot;&gt;${item.original}&lt;/span&gt;&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-green-600&quot;&gt;&#272;&#7873; xu&#7845;t: &lt;span class=&quot;font-bold&quot;&gt;${item.suggestion}&lt;/span&gt;&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;mt-3 explanation&quot; id=&quot;explanation-${index}&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;p class=&quot;text-xs text-gray-700 bg-gray-100 p-2 rounded-md&quot;&gt;${item.explanation}&lt;/p&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class=&quot;mt-3 flex items-center justify-between&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;button class=&quot;explain-btn text-xs text-blue-600 hover:underline&quot; data-target-id=&quot;explanation-${index}&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;i class=&quot;fas fa-circle-info mr-1&quot;&gt;&lt;/i&gt;T&#7841;i sao?<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;button class=&quot;apply-btn bg-green-500 hover:bg-green-600 text-white text-sm font-bold py-1 px-3 rounded-md transition-colors&quot; data-original=&quot;${item.original}&quot; data-suggestion=&quot;${item.suggestion}&quot;&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&Aacute;p d&#7909;ng<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/button&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;list.appendChild(card);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});<br><br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// G&aacute;n s&#7921; ki&#7879;n<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.querySelectorAll(&#39;.apply-btn&#39;).forEach(b =&gt; b.onclick = handleApply);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.querySelectorAll(&#39;.ignore-btn&#39;).forEach(b =&gt; b.onclick = handleIgnore);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.querySelectorAll(&#39;.explain-btn&#39;).forEach(b =&gt; b.onclick = handleExplain);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;function handleApply(event) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const btn = event.currentTarget;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;applySuggestion(btn.dataset.original, btn.dataset.suggestion);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;btn.closest(&#39;.suggestion-card&#39;).remove();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;updateSummaryAfterAction();<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;function handleIgnore(event) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(event.currentTarget.dataset.cardId).remove();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;updateSummaryAfterAction();<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;function handleExplain(event) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const targetId = event.currentTarget.dataset.targetId;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;document.getElementById(targetId).classList.toggle(&#39;show&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;async function applySuggestion(original, suggestion) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await Word.run(async (context) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const searchResults = context.document.body.search(original, { matchCase: true });<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;searchResults.load(&#39;items&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await context.sync();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (searchResults.items.length &gt; 0) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;searchResults.items[0].insertText(suggestion, &#39;Replace&#39;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;await context.sync();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}).catch(error =&gt; console.error(error));<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;<br> &nbsp; &nbsp; &nbsp; &nbsp;// C&aacute;c h&agrave;m ti&#7879;n &iacute;ch (showPlaceholder, updateSummary, updateSummaryAfterAction)<br> &nbsp; &nbsp; &nbsp; &nbsp;function showPlaceholder(title, message) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const placeholder = document.getElementById(&quot;placeholder&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;placeholder.classList.remove(&quot;hidden&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;placeholder.querySelector(&#39;h3&#39;).innerText = title;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;placeholder.querySelector(&#39;p&#39;).innerText = message;<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;function updateSummary(suggestions) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const summaryEl = document.getElementById(&quot;summary&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (suggestions.length &gt; 0) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;summaryEl.innerHTML = `AI &#273;&atilde; t&igrave;m th&#7845;y &lt;strong&gt;${suggestions.length}&lt;/strong&gt; &#273;&#7873; xu&#7845;t &#273;&#7875; c&#7843;i thi&#7879;n v&#259;n b&#7843;n.`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;summaryEl.classList.remove(&quot;hidden&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; summaryEl.classList.add(&quot;hidden&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp; &nbsp; &nbsp;function updateSummaryAfterAction() {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const remainingCards = document.querySelectorAll(&#39;.suggestion-card&#39;).length;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const summaryEl = document.getElementById(&quot;summary&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (remainingCards &gt; 0) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;summaryEl.innerHTML = `C&ograve;n l&#7841;i &lt;strong&gt;${remainingCards}&lt;/strong&gt; &#273;&#7873; xu&#7845;t c&#7847;n x&#7917; l&yacute;.`;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;summaryEl.classList.add(&quot;hidden&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;showPlaceholder(&quot;Ho&agrave;n t&#7845;t!&quot;, &quot;T&#7845;t c&#7843; c&aacute;c &#273;&#7873; xu&#7845;t &#273;&atilde; &#273;&#432;&#7907;c x&#7917; l&yacute;.&quot;);<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br><br> &nbsp; &nbsp;&lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></span></p></body></html>